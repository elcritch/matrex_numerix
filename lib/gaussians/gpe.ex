
defmodule MatrexNumerix.GPE do
  alias __MODULE__
  alias MatrexNumerix.GP.Mean
  use Matrex.Operators

  @moduledoc """
  Linear regression functions.

  Taken from `MatrexNumerix` project at https://github.com/safwank/MatrexNumerix under the MIT license.
  """

  defstruct [:kdata, :kmod, :kern, :xx, :y, :logNoise]

  def calculate(xx = %Matrex{}, y = %Matrex{}, mean = %{}, kernel = %{__struct__: kmod}, logNoise) do
    kdata = kmod.kern_dist(xx, xx)

    %GPE{kdata: kdata, kmod: kmod, kern: kernel, xx: xx, y: y, logNoise: logNoise}
  end

end

"""
15] chol: LinearAlgebra.Cholesky{Float64,Array{Float64,2}}(
  [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
  0.891860705058954 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
  0.8962031669952231 0.698488956618627 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
  0.010519326759677965 0.006466380874689093 0.016821456790142585 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
  0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
  0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
  0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
  0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
  0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 0.5680197599089813 -0.004256596637965718;
  0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 0.500221349757034], 'U', 0)

11] chol_factors:
  [1.1353352832366128 0.891860705058954 0.8962031669952231 0.010519326759677965 0.3144852326610042 0.8041120707773918 0.05825048219777887 0.006685560932908665 0.04198798460196675 0.3038644542413161;
    0.891860705058954 1.1353352832366128 0.698488956618627 0.006466380874689093 0.20984455523780993 0.6020332474468677 0.03669982451747015 0.004091647168550137 0.0262934018853028 0.2023482953743353;
    0.8962031669952231 0.698488956618627 1.1353352832366128 0.016821456790142585 0.45439285757184966 0.9696773331736784 0.09052927935127542 0.010743892517028699 0.06572610840492199 0.4402486378151663;
    0.010519326759677965 0.006466380874689093 0.016821456790142585 1.1353352832366128 0.07749962050911277 0.02117368253961235 0.40014586123829415 0.9038071951544269 0.5167204841999194 0.08060566333984757;
    0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 1.1353352832366128 0.5381247731253018 0.35803683258002683 0.05069430553405346 0.27086807533238516 0.9988524453406431;
    0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 1.1353352832366128 0.11212493763757392 0.01356064636227726 0.08174306236426206 0.5223017924975333;
    0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 1.1353352832366128 0.27892104237355764 0.9394563878756726 0.37015590818116373;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 1.1353352832366128 0.36815392190869095 0.05277118436242623;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 1.1353352832366128 0.280517364073899;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 1.1353352832366128]

19] C:
  [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
   0.891860705058954 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
   0.8962031669952231 0.698488956618627 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
   0.010519326759677965 0.006466380874689093 0.016821456790142585 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
   0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
   0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
   0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
   0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
   0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 0.5680197599089813 -0.004256596637965718;
   0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 0.500221349757034]

21] C:
  [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
    0.0 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
    0.0 0.0 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
    0.0 0.0 0.0 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
    0.0 0.0 0.0 0.0 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
    0.0 0.0 0.0 0.0 0.0 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
    0.0 0.0 0.0 0.0 0.0 0.0 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.5680197599089813 -0.004256596637965718;
    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.500221349757034]

14] chol: LinearAlgebra.Cholesky{Float64,Array{Float64,2}}
   [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
    0.891860705058954 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
    0.8962031669952231 0.698488956618627 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
    0.010519326759677965 0.006466380874689093 0.016821456790142585 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
    0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
    0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
    0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 0.5680197599089813 -0.004256596637965718;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 0.500221349757034], 'U', 0)

4] Σbuffer:
   [1.1353352832366128 0.891860705058954 0.8962031669952231 0.010519326759677965 0.3144852326610042 0.8041120707773918 0.05825048219777887 0.006685560932908665 0.04198798460196675 0.3038644542413161;
    0.891860705058954 1.1353352832366128 0.698488956618627 0.006466380874689093 0.20984455523780993 0.6020332474468677 0.03669982451747015 0.004091647168550137 0.0262934018853028 0.2023482953743353;
    0.8962031669952231 0.698488956618627 1.1353352832366128 0.016821456790142585 0.45439285757184966 0.9696773331736784 0.09052927935127542 0.010743892517028699 0.06572610840492199 0.4402486378151663;
    0.010519326759677965 0.006466380874689093 0.016821456790142585 1.1353352832366128 0.07749962050911277 0.02117368253961235 0.40014586123829415 0.9038071951544269 0.5167204841999194 0.08060566333984757;
    0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 1.1353352832366128 0.5381247731253018 0.35803683258002683 0.05069430553405346 0.27086807533238516 0.9988524453406431;
    0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 1.1353352832366128 0.11212493763757392 0.01356064636227726 0.08174306236426206 0.5223017924975333;
    0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 1.1353352832366128 0.27892104237355764 0.9394563878756726 0.37015590818116373;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 1.1353352832366128 0.36815392190869095 0.05277118436242623;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 1.1353352832366128 0.280517364073899;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 1.1353352832366128]

12] m:
   [1.1353352832366128 0.891860705058954 0.8962031669952231 0.010519326759677965 0.3144852326610042 0.8041120707773918 0.05825048219777887 0.006685560932908665 0.04198798460196675 0.3038644542413161;
    0.891860705058954 1.1353352832366128 0.698488956618627 0.006466380874689093 0.20984455523780993 0.6020332474468677 0.03669982451747015 0.004091647168550137 0.0262934018853028 0.2023482953743353;
    0.8962031669952231 0.698488956618627 1.1353352832366128 0.016821456790142585 0.45439285757184966 0.9696773331736784 0.09052927935127542 0.010743892517028699 0.06572610840492199 0.4402486378151663;
    0.010519326759677965 0.006466380874689093 0.016821456790142585 1.1353352832366128 0.07749962050911277 0.02117368253961235 0.40014586123829415 0.9038071951544269 0.5167204841999194 0.08060566333984757;
    0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 1.1353352832366128 0.5381247731253018 0.35803683258002683 0.05069430553405346 0.27086807533238516 0.9988524453406431;
    0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 1.1353352832366128 0.11212493763757392 0.01356064636227726 0.08174306236426206 0.5223017924975333;
    0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 1.1353352832366128 0.27892104237355764 0.9394563878756726 0.37015590818116373;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 1.1353352832366128 0.36815392190869095 0.05277118436242623;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 1.1353352832366128 0.280517364073899;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 1.1353352832366128]

11] chol_factors:
   [1.1353352832366128 0.891860705058954 0.8962031669952231 0.010519326759677965 0.3144852326610042 0.8041120707773918 0.05825048219777887 0.006685560932908665 0.04198798460196675 0.3038644542413161;
    0.891860705058954 1.1353352832366128 0.698488956618627 0.006466380874689093 0.20984455523780993 0.6020332474468677 0.03669982451747015 0.004091647168550137 0.0262934018853028 0.2023482953743353;
    0.8962031669952231 0.698488956618627 1.1353352832366128 0.016821456790142585 0.45439285757184966 0.9696773331736784 0.09052927935127542 0.010743892517028699 0.06572610840492199 0.4402486378151663;
    0.010519326759677965 0.006466380874689093 0.016821456790142585 1.1353352832366128 0.07749962050911277 0.02117368253961235 0.40014586123829415 0.9038071951544269 0.5167204841999194 0.08060566333984757;
    0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 1.1353352832366128 0.5381247731253018 0.35803683258002683 0.05069430553405346 0.27086807533238516 0.9988524453406431;
    0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 1.1353352832366128 0.11212493763757392 0.01356064636227726 0.08174306236426206 0.5223017924975333;
    0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 1.1353352832366128 0.27892104237355764 0.9394563878756726 0.37015590818116373;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 1.1353352832366128 0.36815392190869095 0.05277118436242623;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 1.1353352832366128 0.280517364073899;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 1.1353352832366128]

  18] A:
    [1.1353352832366128 0.891860705058954 0.8962031669952231 0.010519326759677965 0.3144852326610042 0.8041120707773918 0.05825048219777887 0.006685560932908665 0.04198798460196675 0.3038644542413161;
      0.891860705058954 1.1353352832366128 0.698488956618627 0.006466380874689093 0.20984455523780993 0.6020332474468677 0.03669982451747015 0.004091647168550137 0.0262934018853028 0.2023482953743353;
      0.8962031669952231 0.698488956618627 1.1353352832366128 0.016821456790142585 0.45439285757184966 0.9696773331736784 0.09052927935127542 0.010743892517028699 0.06572610840492199 0.4402486378151663;
      0.010519326759677965 0.006466380874689093 0.016821456790142585 1.1353352832366128 0.07749962050911277 0.02117368253961235 0.40014586123829415 0.9038071951544269 0.5167204841999194 0.08060566333984757;
      0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 1.1353352832366128 0.5381247731253018 0.35803683258002683 0.05069430553405346 0.27086807533238516 0.9988524453406431;
      0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 1.1353352832366128 0.11212493763757392 0.01356064636227726 0.08174306236426206 0.5223017924975333;
      0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 1.1353352832366128 0.27892104237355764 0.9394563878756726 0.37015590818116373;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 1.1353352832366128 0.36815392190869095 0.05277118436242623;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 1.1353352832366128 0.280517364073899;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 1.1353352832366128]

27] A:
 [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
  0.8370183172146907 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
  0.8410937520464389 -0.008374859394259212 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
  0.00987247126448417 -0.0027255213008690465 0.012987554218730425 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
  0.29514687522126465 -0.05641780030000372 0.31444590855187565 0.06603024118416854 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
  0.7546655307452099 -0.04494707973204778 0.5114881628851006 0.006530722402382234 0.15619834858243634 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
  0.054668537709491566 -0.013739006286075462 0.06793136998236544 0.3742154611352331 0.3040355424783682 -0.02737903874003101 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
  0.006274451750096541 -0.0017596010523008223 0.008334939141939307 0.8481681560170662 -0.01018323846938514 0.0010145568326900935 -0.03837025302551177 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
  0.03940605524542245 -0.010146721023951645 0.049683102904699565 0.4840079226944727 0.21750707350581863 -0.02087054376466274 0.7253616614372566 -0.02016224197949403 0.5680197599089813 -0.004256596637965718;
  0.2851791907724136 -0.055133381969485376 0.3056554443042809 0.06914844885777402 0.8355719145273359 0.03283293062958291 0.057126319823606816 0.0005518174031733379 -0.004256596637965718 0.500221349757034]

21] C:
   [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
    0.0 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
    0.0 0.0 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
    0.0 0.0 0.0 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
    0.0 0.0 0.0 0.0 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
    0.0 0.0 0.0 0.0 0.0 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
    0.0 0.0 0.0 0.0 0.0 0.0 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.5680197599089813 -0.004256596637965718;
    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.500221349757034]

29] C.data: [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
0.891860705058954 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
0.8962031669952231 0.698488956618627 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
0.010519326759677965 0.006466380874689093 0.016821456790142585 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 0.5680197599089813 -0.004256596637965718;
0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 0.500221349757034]

21] C:
chol_factors = Matrex.new
  1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
  0.0 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
  0.0 0.0 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
  0.0 0.0 0.0 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
  0.0 0.0 0.0 0.0 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
  0.0 0.0 0.0 0.0 0.0 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
  0.0 0.0 0.0 0.0 0.0 0.0 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
  0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
  0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.5680197599089813 -0.004256596637965718;
  0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.500221349757034

29] C.data: [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
0.891860705058954 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
0.8962031669952231 0.698488956618627 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
0.010519326759677965 0.006466380874689093 0.016821456790142585 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 0.5680197599089813 -0.004256596637965718;
0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 0.500221349757034]

28] factors-pre:
  [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
    0.891860705058954 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
    0.8962031669952231 0.698488956618627 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
    0.010519326759677965 0.006466380874689093 0.016821456790142585 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
    0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
    0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
    0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 0.5680197599089813 -0.004256596637965718;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 0.500221349757034]

  25] factors:
    [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
      0.891860705058954 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
      0.8962031669952231 0.698488956618627 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
      0.010519326759677965 0.006466380874689093 0.016821456790142585 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
      0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
      0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
      0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 0.5680197599089813 -0.004256596637965718;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 0.500221349757034]

    24] gp.cK: PDMats.PDMat{Float64,Array{Float64,2}}(10,
      [1.1353352832366128 0.891860705058954 0.8962031669952231 0.010519326759677965 0.3144852326610042 0.8041120707773918 0.05825048219777887 0.006685560932908665 0.04198798460196675 0.3038644542413161;
        0.891860705058954 1.1353352832366128 0.698488956618627 0.006466380874689093 0.20984455523780993 0.6020332474468677 0.03669982451747015 0.004091647168550137 0.0262934018853028 0.2023482953743353;
        0.8962031669952231 0.698488956618627 1.1353352832366128 0.016821456790142585 0.45439285757184966 0.9696773331736784 0.09052927935127542 0.010743892517028699 0.06572610840492199 0.4402486378151663;
        0.010519326759677965 0.006466380874689093 0.016821456790142585 1.1353352832366128 0.07749962050911277 0.02117368253961235 0.40014586123829415 0.9038071951544269 0.5167204841999194 0.08060566333984757;
        0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 1.1353352832366128 0.5381247731253018 0.35803683258002683 0.05069430553405346 0.27086807533238516 0.9988524453406431;
        0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 1.1353352832366128 0.11212493763757392 0.01356064636227726 0.08174306236426206 0.5223017924975333;
        0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 1.1353352832366128 0.27892104237355764 0.9394563878756726 0.37015590818116373;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 1.1353352832366128 0.36815392190869095 0.05277118436242623;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 1.1353352832366128 0.280517364073899;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 1.1353352832366128],
LinearAlgebra.Cholesky{Float64,Array{Float64,2}}(
  [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
    0.891860705058954 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
    0.8962031669952231 0.698488956618627 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
    0.010519326759677965 0.006466380874689093 0.016821456790142585 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
    0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
    0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
    0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 0.5680197599089813 -0.004256596637965718;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 0.500221349757034], 'U', 0))


24] gp.cK: PDMats.PDMat{Float64,Array{Float64,2}}(10,
   [1.1353352832366128 0.891860705058954 0.8962031669952231 0.010519326759677965 0.3144852326610042 0.8041120707773918 0.05825048219777887 0.006685560932908665 0.04198798460196675 0.3038644542413161;
    0.891860705058954 1.1353352832366128 0.698488956618627 0.006466380874689093 0.20984455523780993 0.6020332474468677 0.03669982451747015 0.004091647168550137 0.0262934018853028 0.2023482953743353;
    0.8962031669952231 0.698488956618627 1.1353352832366128 0.016821456790142585 0.45439285757184966 0.9696773331736784 0.09052927935127542 0.010743892517028699 0.06572610840492199 0.4402486378151663;
    0.010519326759677965 0.006466380874689093 0.016821456790142585 1.1353352832366128 0.07749962050911277 0.02117368253961235 0.40014586123829415 0.9038071951544269 0.5167204841999194 0.08060566333984757;
    0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 1.1353352832366128 0.5381247731253018 0.35803683258002683 0.05069430553405346 0.27086807533238516 0.9988524453406431;
    0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 1.1353352832366128 0.11212493763757392 0.01356064636227726 0.08174306236426206 0.5223017924975333;
    0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 1.1353352832366128 0.27892104237355764 0.9394563878756726 0.37015590818116373;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 1.1353352832366128 0.36815392190869095 0.05277118436242623;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 1.1353352832366128 0.280517364073899;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 1.1353352832366128],
  LinearAlgebra.Cholesky{Float64,Array{Float64,2}}(
   [1.0655211322337126 0.8370183172146907 0.8410937520464389 0.00987247126448417 0.29514687522126465 0.7546655307452099 0.054668537709491566 0.006274451750096541 0.03940605524542245 0.2851791907724136;
    0.891860705058954 0.6593448414022061 -0.008374859394259212 -0.0027255213008690465 -0.05641780030000372 -0.04494707973204778 -0.013739006286075462 -0.0017596010523008223 -0.010146721023951645 -0.055133381969485376;
    0.8962031669952231 0.698488956618627 0.6540844328029699 0.012987554218730425 0.31444590855187565 0.5114881628851006 0.06793136998236544 0.008334939141939307 0.049683102904699565 0.3056554443042809;
    0.010519326759677965 0.006466380874689093 0.016821456790142585 1.0653927503586642 0.06603024118416854 0.006530722402382234 0.3742154611352331 0.8481681560170662 0.4840079226944727 0.06914844885777402;
    0.3144852326610042 0.20984455523780993 0.45439285757184966 0.07749962050911277 0.970466081291454 0.15619834858243634 0.3040355424783682 -0.01018323846938514 0.21750707350581863 0.8355719145273359;
    0.8041120707773918 0.6020332474468677 0.9696773331736784 0.02117368253961235 0.5381247731253018 0.5270049950035312 -0.02737903874003101 0.0010145568326900935 -0.02087054376466274 0.03283293062958291;
    0.05825048219777887 0.03669982451747015 0.09052927935127542 0.40014586123829415 0.35803683258002683 0.11212493763757392 0.9456842859510831 -0.03837025302551177 0.7253616614372566 0.057126319823606816;
    0.006685560932908665 0.004091647168550137 0.010743892517028699 0.9038071951544269 0.05069430553405346 0.01356064636227726 0.27892104237355764 0.6436280930906934 -0.02016224197949403 0.0005518174031733379;
    0.04198798460196675 0.0262934018853028 0.06572610840492199 0.5167204841999194 0.27086807533238516 0.08174306236426206 0.9394563878756726 0.36815392190869095 0.5680197599089813 -0.004256596637965718;
    0.3038644542413161 0.2023482953743353 0.4402486378151663 0.08060566333984757 0.9988524453406431 0.5223017924975333 0.37015590818116373 0.05277118436242623 0.280517364073899 0.500221349757034], 'U', 0))

31] X:
  [4.854610892030431 5.176527683588912 4.54059036660107 1.0556100264266548 3.484869973967117 4.3852256899673066 2.2228785289423754 0.7556418525131632 1.9941157865846477 3.4567590405289352]

  defprotocol SensorComputations.GP.Calc do
    @doc "Calculate Kernel"
    def calc(kern, xdata)
  end

  defimpl SensorComputations.GP.Calc, for: SensorComputations.GP.Mat32 do

"""
